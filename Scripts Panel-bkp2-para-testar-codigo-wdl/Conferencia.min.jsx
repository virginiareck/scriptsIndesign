var myDocument=app.activeDocument,nomeEntidadeGrande=new Array,titulos=encontrar("titulo"),entidades=encontrar("entidade"),consorcios=encontrar("entidade - consorcio",nomeEntidadeGrande),associacoes=encontrar("entidade - associacao",nomeEntidadeGrande),multas=encontrar("entidade - multas"),referencias=encontrar("codAto"),municipios=encontrar("municipio"),msgErro=localizaErroCodato();function main(){var e="",n=!1;titulos!=referencias&&(e="ALERTA!!!\r\rNúmero dos Titulos DIFERENTE do Numero dos CodAtos\r-------------------------------------------------------\r\r",n=!0),nomeEntidadeGrande.length>0&&(msgErro+="\r\r-------------------------------------------------------\r\rAtenção! Foram encontradas entidades com nome muito extenso:\r\r"+nomeEntidadeGrande.reverse().join("\r")),alert(e+"Municipios :\t"+municipios+"\t\tTitulos :\t\t"+titulos+"\rEntidades :\t"+entidades+" \t\tCodAto :\t\t"+referencias+"\r\rAssociações :\t"+associacoes+"\t\rConsórcios :\t"+consorcios+" \r\rEntidades Multas :\t"+multas+" \r\r--------------------------------------------------\r"+msgErro,"Conferencia de titulos x atos",n)}function encontrar(e,n){app.findTextPreferences.findWhat="",app.changeTextPreferences.changeTo="";var a=0;app.findChangeTextOptions.caseSensitive=!1,app.findChangeTextOptions.includeFootnotes=!1,app.findChangeTextOptions.includeHiddenLayers=!1,app.findChangeTextOptions.includeLockedLayersForFind=!0,app.findChangeTextOptions.includeLockedStoriesForFind=!0,app.findChangeTextOptions.includeMasterPages=!1,app.findChangeTextOptions.wholeWord=!1;var t,r=myDocument.paragraphStyles.item(e);if(!r.isValid)return 0;if(app.findTextPreferences.appliedParagraphStyle=r,a+=(t=0!=app.selection.length?app.selection[0].findText():myDocument.findText()).length,n)for(var i=0;i<t.length;i++)t[i].length>20&&n.unshift(""+t[i].contents);return a}function localizaErroCodato(){var e=app.activeDocument;app.findTextPreferences.findWhat="",app.changeTextPreferences.changeTo="",app.findChangeTextOptions.caseSensitive=!1,app.findChangeTextOptions.includeFootnotes=!1,app.findChangeTextOptions.includeHiddenLayers=!1,app.findChangeTextOptions.includeLockedLayersForFind=!1,app.findChangeTextOptions.includeLockedStoriesForFind=!1,app.findChangeTextOptions.includeMasterPages=!1,app.findChangeTextOptions.wholeWord=!1,app.findTextPreferences.appliedParagraphStyle="codAto";for(var n=e.findText(),a=new Array,t=0;t<n.length;t++)try{r="parentPage"in n[t].parentTextFrames[0]?n[t].parentTextFrames[0].parentPage.name:n[t].parentTextFrames[0].parent.name,null==a[r=String(r).replace(/[^\d]/g,"")]&&(a[r]=0),a[r]++}catch(e){}app.findTextPreferences.findWhat="",app.changeTextPreferences.changeTo="",app.findChangeTextOptions.caseSensitive=!1,app.findChangeTextOptions.includeFootnotes=!1,app.findChangeTextOptions.includeHiddenLayers=!1,app.findChangeTextOptions.includeLockedLayersForFind=!1,app.findChangeTextOptions.includeLockedStoriesForFind=!1,app.findChangeTextOptions.includeMasterPages=!1,app.findChangeTextOptions.wholeWord=!1,app.findTextPreferences.appliedParagraphStyle="titulo";for(n=e.findText(),t=0;t<n.length;t++)try{var r;r="parentPage"in n[t].parentTextFrames[0]?n[t].parentTextFrames[0].parentPage.name:n[t].parentTextFrames[0].parent.name,null==a[r=String(r).replace(/[^\d]/g,"")]&&(a[r]=0),a[r]--}catch(e){}var i="";for(page=0;page<a.length;page++)void 0!==a[page]&&0!==a[page]&&(i+=page+" ,   ");return""!=i?"Falha na(s) página(s):  "+i:"Nenhum problema de Titulo x codAto encontrado!"}main();